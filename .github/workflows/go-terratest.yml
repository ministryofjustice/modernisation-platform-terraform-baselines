on:
    pull_request:
      types: [opened, edited, reopened, synchronize]
  permissions: {}
  env:
    AWS_ACCESS_KEY_ID:  ${{ secrets.AWS_ACCESS_KEY_ID }}
    AWS_SECRET_ACCESS_KEY:  ${{ secrets.AWS_SECRET_ACCESS_KEY }}
    TF_IN_AUTOMATION: true
  jobs:
    go-tests:
      permissions:
        contents: read
        actions: write
      name: Run Go Unit Tests
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@0ad4b8fadaa221de15dcec353f45205ec38ea70b # v4.1.4
        - uses: actions/setup-go@cdcb36043654635271a94b9a6d1392de5bb323a7 # v5.0.1
          with:
            go-version: 1.18
        - uses: hashicorp/setup-terraform@97f030cf6dc0b4f5e0da352c7bca9cca34579800 # v3.1.0
          with:
            terraform_version: ~1.3
            terraform_wrapper: false
        - name: Download Go Modules
          working-directory: test
          run: go mod download
        - name: Run Go Tests
          working-directory: test
          run: go test -v